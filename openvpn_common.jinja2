#ovpn-common.jinja2 - CN={{ CN }}
#PES 2018-07-12 template
verb 3
dev tun-az
#Azure-vpn-vm=13.73.199.180
#Azure-ras-vm=13.75.221.215

{% if is_server %} #SERVER
bb {{ server }}
aa {{ server['server'] }}
xx server yy{{ server['server'][ 'ip_pool' ] }}
#route
tls-server
remote-cert-tls client
tls-auth direction 0
#client-config-dir ccd
# # iroute

{% else %} #CLIENT
#{{ servers }}
client
nobind
remote-random
{% for server in servers %}
{%     set s = server['server'] %}
<connection>
  # {{ s['name'] }}
  remote {{ s['connect'] }}
  #tls-remote <CN>
</connection>
{% endfor %}

tls-client
#only allow certs issued to server's
#remote-cert-tls server
ns-cert-type server
tls-auth direction 1

{% endif %}

#From v2.4 tls-crypt can be used
cipher AES-256-CBC

comp-lzo
keepalive 10 60
ping-timer-rem
persist-tun
persist-key
user nobody
group nogroup
daemon

<ca>
{{ cacert }}
</ca>

#cert CN="{{ CN }}"
<cert>
{{ clientcert }}
</cert>

#key CN="{{ CN }}"
<key>
{{ clientkey }}
</key>

<tls-auth>
{{ tlsauth_key }}
</tls-auth>

<dh>
{{ dh }}
</dh>

#THE END.

